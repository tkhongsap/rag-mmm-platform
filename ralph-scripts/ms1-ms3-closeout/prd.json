{
  "project": "RAG MMM Platform",
  "branchName": "ralph/ms1-ms3-closeout-strict-parity",
  "description": "Close strict checklist parity gaps for MS-1 (#80), MS-2 (#81), and MS-3 (#82) while preserving API compatibility and passing verification tests.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Align MS-1 ignore rules",
      "description": "As a maintainer, I want .gitignore entries to match issue #80 wording so milestone closure is unambiguous.",
      "acceptanceCriteria": [
        "Add data/assets/*.png to .gitignore",
        "Add data/qdrant_db/ to .gitignore",
        "Run .venv/bin/python data/generators/generate_all.py --validate-only successfully",
        "Do not remove unrelated ignore rules",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Add MS-2 query engine builders",
      "description": "As a RAG developer, I want explicit query engine builder functions so code matches issue #81 interface expectations.",
      "acceptanceCriteria": [
        "Implement build_text_query_engine(...) in src/rag/retrieval/query_engine.py",
        "Implement build_asset_query_engine(...) in src/rag/retrieval/query_engine.py",
        "Update search_text(...) and search_assets(...) to use the builder path",
        "Keep retrieval smoke tests passing",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Apply explicit SentenceSplitter configuration",
      "description": "As a reviewer, I want splitter configuration explicitly represented in indexing so implementation matches issue #81 wording.",
      "acceptanceCriteria": [
        "Use SentenceSplitter(chunk_size=1024, chunk_overlap=50) in the text indexing path",
        "Preserve text index build behavior with no regression",
        "Add or update tests to verify splitter usage or equivalent observable behavior",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Add filter_by_channel MCP tool",
      "description": "As an orchestrator developer, I want a third MCP tool so #82 KR1 and task 3.2 are fully satisfied.",
      "acceptanceCriteria": [
        "Implement filter_by_channel in src/platform/api/agents/tools.py",
        "Make filter_by_channel call a retrieval-layer filtering function",
        "Register filter_by_channel in rag_mcp_server tool list",
        "Export filter_by_channel from src/platform/api/agents/__init__.py",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Register all three MCP tools in the router",
      "description": "As an API integrator, I want rag-analyst to expose all required MCP tools for strict #82 parity.",
      "acceptanceCriteria": [
        "Include mcp__rag-tools__search_data in rag-analyst tools",
        "Include mcp__rag-tools__search_assets in rag-analyst tools",
        "Include mcp__rag-tools__filter_by_channel in rag-analyst tools",
        "Include the same three MCP tools in allowed_tools",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Add explicit decomposition routing path",
      "description": "As a product owner, I want complex query decomposition handled by routing logic, not only prompt guidance.",
      "acceptanceCriteria": [
        "Detect comparative, multi-timeframe, and cross-category query patterns in router logic",
        "Apply decomposition instruction path before agent query for complex prompts",
        "Verify complex queries trigger decomposition path in tests",
        "Verify simple queries do not trigger unnecessary decomposition",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Preserve RAG chat API contract and fallback",
      "description": "As a client developer, I want closeout work to avoid breaking current API clients.",
      "acceptanceCriteria": [
        "Keep POST /api/rag/chat response shape as {reply, sources, session_id, agent_used}",
        "Preserve session continuity behavior",
        "Preserve fallback to file-reader under tool or router failures",
        "Keep existing integration tests passing",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    }
  ]
}
